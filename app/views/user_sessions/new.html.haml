= javascript_include_tag "https://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"

%div.flash= raw "#{raw flash[:info]} #{raw flash[:error]}"
- if @user_session.errors.any?
  %div.error_explanation
    -@user_session.errors.full_messages.each do |msg|
      %ul
        %li= msg

%h2 Sign in to Fluxx
= form_for(@user_session, :url => user_sessions_path) do |f|

  %p
    = f.label :login
    = f.text_field :login, :placeholder => 'Login'
  %p
    = f.label :password, :placeholder => 'Password'
    = f.password_field :password
  %p= f.submit "Sign in"
  %p
    = f.check_box :remember_me
    = f.label :remember_me
  - unless Fluxx.config(:hide_loi) == "1"
    %p &nbsp;
    %p
      = link_to "New to the  #{Fluxx.config(:grantor_name)}'s Grants Portal?", new_loi_path
      %br
      = link_to "Create an account here.", new_loi_path

:javascript
  function IsGCFNeeded() {
    if($.browser.msie) {
      try {
        var i = new ActiveXObject('ChromeTab.ChromeFrame');
        if (i) {
          return false;
        }
      } catch(e) {
        return true;
        // squelch
      }
      return true;
    }
    return false;
  };
  if (IsGCFNeeded()) {
    $('.content, .pinwheel').hide();
    CFInstall.check({
      url: '/install_chrome_frame.html',
      mode: 'inline'
    });
  }

